## EKS Cluster Monitoring Dashboard Metrics 정리

### 1. Node Metrics (노드 메트릭)

| Metric | 설명 | 사용 이유 | 임계값 | 임계값 설정 이유 |
| --- | --- | --- | --- | --- |
| `node_cpu_utilization` | 노드의 CPU 사용률 (%) | 노드의 컴퓨팅 리소스 부족 감지 및 스케일링 필요성 판단 | **80%** | 80% 이상 시 성능 저하 발생 가능, 버퍼 확보를 위한 업계 표준 임계값 |
| `node_memory_utilization` | 노드의 메모리 사용률 (%) | OOM(Out of Memory) 방지 및 메모리 누수 조기 탐지 | **80%** | 메모리 부족 시 Pod eviction 발생, 20% 여유 공간 확보 필요 |
| `node_disk_utilization` | 노드의 디스크 사용률 (%) | 디스크 풀로 인한 서비스 장애 예방 | **80%** | 디스크 부족 시 로그/이미지 저장 불가, 여유 공간 필수 |
| `cluster_node_count` | 클러스터 내 전체 노드 수 | 클러스터 규모 모니터링 및 노드 가용성 확인 | - | 모니터링 용도 (임계값 없음) |
| `cluster_failed_node_count` | 실패 상태의 노드 수 | 장애 노드 즉시 감지 및 대응 | - | 0이 아닌 경우 즉시 조치 필요 |

### 2. EC2 Status Check (EC2 상태 확인)

| Metric | 설명 | 사용 이유 | 임계값 | 임계값 설정 이유 |
| --- | --- | --- | --- | --- |
| `StatusCheckFailed` | EC2 상태 체크 실패 총합 | 인스턴스 전체 헬스 체크 | - | 1 이상이면 즉시 조사 필요 |
| `StatusCheckFailed_Instance` | 인스턴스 레벨 체크 실패 | 소프트웨어/네트워크 문제 감지 | - | 재부팅으로 복구 가능 여부 판단 |
| `StatusCheckFailed_System` | 시스템 레벨 체크 실패 | AWS 인프라/하드웨어 문제 감지 | - | AWS 측 문제로 인스턴스 마이그레이션 필요 |

### 3. Container/Pod Metrics (컨테이너/Pod 메트릭)

| Metric | 설명 | 사용 이유 | 임계값 | 임계값 설정 이유 |
| --- | --- | --- | --- | --- |
| `pod_cpu_utilization` | Pod의 CPU 사용률 (%) | 개별 애플리케이션 리소스 사용량 모니터링 | - | 모니터링 용도 |
| `pod_memory_utilization` | Pod의 메모리 사용률 (%) | 메모리 누수 및 리소스 부족 감지 | - | 모니터링 용도 |
| `pod_number_of_container_restarts` | Pod 내 컨테이너 재시작 횟수 | CrashLoopBackOff 등 비정상 상태 감지, 자동 복구 트리거 | **5회** | 5회 이상 재시작 시 근본적인 문제 존재, 자동 복구 실행 |
| `container_cpu_utilization` | 컨테이너 CPU 사용률 (%) | 세부 컨테이너 레벨 리소스 모니터링 | **80%** | 리소스 limits 도달 전 조치 필요 |
| `container_memory_utilization` | 컨테이너 메모리 사용률 (%) | OOMKilled 방지 | **80%** | 메모리 limits 도달 시 컨테이너 종료됨 |
| `pod_network_rx_bytes` | Pod 네트워크 수신 바이트 | 네트워크 트래픽 패턴 분석 | - | 모니터링 용도 |
| `pod_network_tx_bytes` | Pod 네트워크 송신 바이트 | 아웃바운드 트래픽 모니터링 | - | 모니터링 용도 |
| `cluster_number_of_running_pods` | 실행 중인 Pod 수 | 클러스터 워크로드 상태 확인 | - | 모니터링 용도 |
| `service_number_of_running_pods` | 서비스 Pod 수 | 서비스 가용성 확인 | - | 모니터링 용도 |

### 4. ALB Metrics (Application Load Balancer 메트릭)

| Metric | 설명 | 사용 이유 | 임계값 | 임계값 설정 이유 |
| --- | --- | --- | --- | --- |
| `RequestCount` | 총 요청 수 | 트래픽 볼륨 및 패턴 분석 | - | 모니터링 용도 |
| `HTTPCode_ELB_5XX_Count` | ELB에서 발생한 5XX 에러 수 | 로드밸런서 레벨 장애 감지 | **10회** | 분당 10회 이상 시 심각한 인프라 문제 의심 |
| `HTTPCode_Target_5XX_Count` | 타겟(백엔드)에서 발생한 5XX 에러 | 애플리케이션 오류 감지 | **10회** | 백엔드 서비스 장애 신속 대응 필요 |
| `TargetResponseTime` (p50/p95/p99) | 타겟 응답 시간 (지연시간) | 사용자 경험 및 성능 모니터링 | **2초** | 2초 이상 응답 시 사용자 이탈률 급증 (업계 표준) |
| `HealthyHostCount` | 정상 타겟 호스트 수 | 백엔드 가용성 확인 | - | 모니터링 용도 |
| `UnHealthyHostCount` | 비정상 타겟 호스트 수 | 장애 호스트 즉시 감지 | - | 0이 아니면 조사 필요 |

### 5. RDS Database Metrics (데이터베이스 메트릭)

| Metric | 설명 | 사용 이유 | 임계값 | 임계값 설정 이유 |
| --- | --- | --- | --- | --- |
| `CPUUtilization` | RDS CPU 사용률 (%) | DB 성능 병목 감지 | **80%** | 쿼리 지연 발생 전 스케일업/최적화 필요 |
| `FreeStorageSpace` | 남은 스토리지 공간 (bytes) | 디스크 풀 방지 | **10GB** (10737418240 bytes) | 10GB 미만 시 긴급 확장 필요, 로그/데이터 증가 대비 |
| `DatabaseConnections` | 현재 DB 연결 수 | 커넥션 풀 고갈 방지 | **100개** | 커넥션 리밋 도달 시 새 연결 불가, 여유분 확보 |
| `DiskQueueDepth` | 디스크 I/O 대기열 깊이 | I/O 병목 현상 감지 | **10** | 10 이상 시 디스크 I/O 포화 상태, IOPS 증설 필요 |

### 6. Route53 Health Check (DNS 헬스체크 & 페일오버)

| Metric | 설명 | 사용 이유 | 임계값 | 임계값 설정 이유 |
| --- | --- | --- | --- | --- |
| `HealthCheckStatus` (Primary) | AWS 기본 엔드포인트 헬스체크 상태 | 멀티클라우드 페일오버의 Primary 상태 확인 | - | 0=Unhealthy, 1=Healthy |
| `HealthCheckStatus` (Secondary) | Azure 백업 엔드포인트 헬스체크 상태 | 페일오버 대상 시스템 가용성 확인 | - | 0=Unhealthy, 1=Healthy |
| `HealthCheckPercentageHealthy` | 헬스체크 성공률 (%) | 전체 헬스체커 중 정상 비율 | **50%** | 50% 미만 시 DNS 페일오버 트리거, Route53 기본 동작 기준 |

---

### 임계값 설정 원칙 요약

임계값	적용 대상	근거
80%	CPU/메모리/디스크	업계 표준, 20% 버퍼로 급증 대응 및 스케일링 시간 확보
5회	Pod 재시작	반복 재시작은 근본 문제 존재 의미, 자동 복구 트리거
10회	HTTP 5XX 에러	허용 가능한 에러율 초과, 즉각 대응 필요
2초	응답 시간	사용자 경험 저하 임계점, Google 연구 기반
10GB	스토리지 여유	긴급 대응 위한 최소 버퍼
100개	DB 커넥션	일반적인 소규모 인스턴스 커넥션 리밋의 60-70%
10	디스크 큐 깊이	I/O 포화 상태 진입 기준
50%	헬스체크 비율	Route53 페일오버 정책 기본 동작 기준