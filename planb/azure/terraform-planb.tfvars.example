# azure/terraform.tfvars.example
# Plan B (Pilot Light) - Azure 설정 예시
# 이 파일을 terraform.tfvars로 복사하고 실제 값으로 수정하세요.

# =================================================
# 배포 가이드
# =================================================

# 1. 이 파일을 복사:
#    cp terraform.tfvars.example terraform.tfvars
#
# 2. Azure 구독 정보 입력 (필수)
#
# 3. Storage Account 이름 지정 (전역 고유)
#
# 4. SSH 키 생성:
#    ssh-keygen -t rsa -b 4096 -f ~/.ssh/azure_dr_key
#    cat ~/.ssh/azure_dr_key.pub
#
# 5. 배포:
#    terraform init
#    terraform plan
#    terraform apply

# =================================================
# 기본 설정
# =================================================

environment = "prod"
location    = "koreacentral"  # 서울 리전

# =================================================
# Storage Account (평상시 항상 실행)
# =================================================

# Storage Account 이름 (전역 고유, 소문자+숫자, 3-24자)
# 예: drbackup + 조직명 + 난수
storage_account_name = "drbackuppetclinic2024"

# Blob Container 이름
backup_container_name = "mysql-backups"

# 백업 보관 기간 (일)
backup_retention_days = 30

# Storage 복제 타입
# - LRS: 로컬 복제 (저렴, $1/월)
# - GRS: 지역 복제 (비싸지만 안전, $2/월)
storage_replication_type = "LRS"

# =================================================
# Azure 구독 정보 (필수)
# =================================================

# Azure Portal → 구독 → 개요에서 확인
subscription_id = "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"

# Azure Portal → Azure Active Directory → 개요에서 확인
tenant_id = "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"

# Azure 구독 정보를 모르면:
# az account show --query "{subscriptionId:id, tenantId:tenantId}"

# =================================================
# 네트워크 설정 (재해 시 사용)
# =================================================

vnet_cidr       = "172.16.0.0/16"
web_subnet_cidr = "172.16.11.0/24"
was_subnet_cidr = "172.16.21.0/24"
db_subnet_cidr  = "172.16.31.0/24"

# =================================================
# 데이터베이스 설정 (재해 시 사용)
# =================================================

db_name     = "petclinic"
db_username = "mysqladmin"

# 비밀번호 요구사항:
# - 8자 이상
# - 대문자, 소문자, 숫자, 특수문자 포함
db_password = "MySecurePassword123!"

# =================================================
# VM 설정 (재해 시 스크립트로 생성)
# =================================================

admin_username = "azureuser"

# SSH 공개 키 (cat ~/.ssh/azure_dr_key.pub)
ssh_public_key = "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC... your-email@example.com"

# VM 크기 (재해 시 생성)
web_vm_size = "Standard_B2s"   # 2 vCPU, 4GB RAM, $60/월
was_vm_size = "Standard_B2ms"  # 2 vCPU, 8GB RAM, $80/월

# =================================================
# MySQL 설정 (재해 시 생성)
# =================================================

mysql_sku        = "B_Standard_B2s"  # 2 vCPU, 4GB RAM, $50/월
mysql_storage_gb = 20                # 20GB, $2/월

# =================================================
# 모니터링 (Storage만 모니터링)
# =================================================

enable_monitoring = true

# =================================================
# 태그 (선택사항)
# =================================================

tags = {
  Environment = "Production"
  DRPlan      = "Plan-B-Pilot-Light"
  ManagedBy   = "Terraform"
  Purpose     = "Disaster-Recovery"
  Team        = "AWS2-Team"
  Project     = "KDT-Bespin-Multi-Cloud"
}

# =================================================
# 중요 참고사항
# =================================================

# Plan B (Pilot Light) 특징:
# 
# 평상시:
#   - Storage Account만 실행 ($12/월)
#   - VM, MySQL 없음
#   - 백업만 수신
#
# 재해 시:
#   - scripts/deploy-maintenance.sh (15분)
#   - scripts/restore-database.sh (60분)
#   - scripts/deploy-petclinic.sh (90분)
#   - 총 RTO: 2-4시간
#
# 비용:
#   - 평상시: $12/월
#   - 재해 시: +$5/시간
#   - 연간: $144 (매우 저렴)
#
# 배포 순서:
#   1. Azure Storage 먼저 생성
#   2. Storage 정보를 AWS에 입력
#   3. AWS 백업 인스턴스 배포
#   4. 백업 자동화 확인
#
# Storage Account 이름 규칙:
#   - 전역에서 고유해야 함
#   - 소문자와 숫자만 사용
#   - 3-24자
#   - 예: drbackuppetclinic2024

# =================================================
# 다음 단계
# =================================================

# 1. 이 파일을 terraform.tfvars로 복사
# 2. 모든 값 수정 (특히 subscription_id, tenant_id, ssh_public_key)
# 3. terraform init
# 4. terraform plan (Storage Account만 생성 확인)
# 5. terraform apply
# 6. Storage Account 정보를 AWS terraform.tfvars에 입력
# 7. AWS 백업 인스턴스 배포
